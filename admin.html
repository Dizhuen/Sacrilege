<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SACRILEGE | Management Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" href="admin.css">
</head>
<body class="min-h-screen flex flex-col">
    <div id="auth-screen" class="fixed inset-0 z-50 bg-[#09090b] flex items-center justify-center p-4">
        <div class="w-full max-w-sm bg-[#18181b] p-8 rounded-xl border border-[#27272a] shadow-2xl">
            <h2 class="text-xl font-bold mb-2 text-white">System Access</h2>
            <form id="login-form" class="space-y-4">
                <input type="email" id="login-email" placeholder="EMAIL" class="text-center font-mono tracking-widest" required>
                <input type="password" id="login-password" placeholder="PASSWORD" class="text-center font-mono tracking-widest" required>
                <button type="submit" class="btn btn-primary w-full">SIGN IN</button>
            </form>
            <div id="auth-message" class="mt-4 text-xs text-red-500 text-center hidden"></div>
        </div>
    </div>

    <div id="app-content" class="hidden opacity-0 transition-opacity duration-500 flex-1 flex flex-col">
        <header class="border-b border-[#27272a] bg-[#09090b]/80 backdrop-blur sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
                <div class="flex items-center gap-3"><div class="w-3 h-3 bg-red-600 rounded-full animate-pulse"></div><span class="font-bold tracking-tight">SACRILEGE <span class="text-gray-500 font-normal">| Admin</span></span></div>
                <button onclick="logout()" class="text-sm text-red-500 hover:text-red-400">Logout</button>
            </div>
        </header>

        <div class="max-w-7xl mx-auto px-6 mt-6 w-full">
            <div class="flex gap-6 border-b border-[#27272a]">
                <button id="tab-products" onclick="switchTab('products')" class="pb-3 text-sm font-bold tab-active">INVENTORY</button>
                <button id="tab-collections" onclick="switchTab('collections')" class="pb-3 text-sm font-bold tab-inactive">COLLECTIONS</button>
                <button id="tab-reviews" onclick="switchTab('reviews')" class="pb-3 text-sm font-bold tab-inactive">REVIEWS</button>
                <button id="tab-contacts" onclick="switchTab('contacts')" class="pb-3 text-sm font-bold tab-inactive">SETTINGS</button>
            </div>
        </div>

        <main class="max-w-7xl mx-auto px-6 py-8 w-full flex-1">
            <!-- PRODUCTS VIEW -->
            <div id="view-products" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 space-y-8">
                    <div class="bg-[#18181b] rounded-xl border border-[#27272a] overflow-hidden">
                        <div class="p-4 border-b border-[#27272a] bg-[#27272a]/30 flex justify-between items-center">
                            <h3 class="font-bold flex items-center gap-2" id="form-title">Add Artifact</h3>
                            <button onclick="resetForm()" id="cancel-edit-btn" class="hidden text-xs text-red-500">Cancel</button>
                        </div>
                        <div class="p-6 space-y-4">
                            <form id="product-form" class="space-y-4">
                                <input type="hidden" name="id" id="prod-id">
                                <input name="name" id="prod-name" placeholder="NAME" required>
                                <input name="category" id="prod-category" placeholder="CATEGORY (e.g. T-SHIRT)">
                                <textarea name="description" id="prod-desc" placeholder="DESCRIPTION" rows="3"></textarea>
                                <div class="grid grid-cols-2 gap-4">
                                    <input name="price" id="prod-price" type="number" placeholder="PRICE (L)" required>
                                    <input name="tag" id="prod-tag" placeholder="TAG (e.g. NEW)">
                                </div>
                                <select name="collection_id" id="prod-col"></select>
                                <div class="bg-[#27272a]/50 p-3 rounded border border-[#3f3f46]">
                                    <label class="block text-xs font-mono text-gray-500 mb-2">STOCK</label>
                                    <div class="grid grid-cols-4 gap-2">
                                        <label class="checkbox-wrapper"><input type="checkbox" id="stock-s" checked> S</label>
                                        <label class="checkbox-wrapper"><input type="checkbox" id="stock-m" checked> M</label>
                                        <label class="checkbox-wrapper"><input type="checkbox" id="stock-l" checked> L</label>
                                        <label class="checkbox-wrapper"><input type="checkbox" id="stock-xl" checked> XL</label>
                                    </div>
                                </div>
                                <div id="gallery-list" class="grid grid-cols-2 gap-3 p-3 bg-black/30 rounded"></div>
                                <button type="button" id="btn-add-image-file" class="btn btn-outline w-full py-2 text-xs">Upload Images</button>
                                <input type="file" id="gallery-file-input" multiple class="hidden">
                                <button type="submit" id="submit-btn" class="btn btn-primary w-full">Save Artifact</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="lg:col-span-2 overflow-x-auto bg-[#18181b] border border-[#27272a] rounded-xl">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-[#27272a]/30 font-mono text-gray-500">
                            <tr><th class="p-4">ARTIFACT</th><th class="p-4">STOCK</th><th class="p-4">PRICE</th><th class="p-4"></th></tr>
                        </thead>
                        <tbody id="product-list" class="divide-y divide-[#27272a]"></tbody>
                    </table>
                </div>
            </div>

            <!-- COLLECTIONS VIEW -->
            <div id="view-collections" class="hidden grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-[#18181b] p-6 rounded-xl border border-[#27272a]">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold" id="col-form-title">Collection Protocol</h3>
                        <button onclick="resetCollectionForm()" id="cancel-col-edit-btn" class="hidden text-xs text-red-500">Cancel</button>
                    </div>
                    <form id="collection-form" class="space-y-4">
                        <input type="hidden" name="id" id="col-id">
                        <input name="title" id="col-title" placeholder="TITLE" required>
                        <div class="space-y-2">
                            <label class="text-xs font-mono text-gray-500">CUSTOM STATUS TEXT</label>
                            <input name="label_text" id="col-label-text" placeholder="e.g. /// READY TO SHIP">
                        </div>
                        <div class="flex items-center gap-3 bg-[#27272a]/30 p-2 rounded border border-[#3f3f46]">
                            <label class="text-xs font-mono text-gray-500">STATUS COLOR:</label>
                            <input type="color" id="col-label-color" value="#DC2626" class="bg-transparent w-8 h-8 border-none cursor-pointer">
                        </div>
                        <button type="submit" id="col-submit-btn" class="btn btn-primary w-full">Create Collection</button>
                    </form>
                </div>
                <div id="collections-list" class="space-y-3"></div>
            </div>

            <!-- REVIEWS VIEW -->
             <div id="view-reviews" class="hidden"><div id="reviews-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div></div>
             
             <!-- CONTACTS VIEW -->
             <div id="view-contacts" class="hidden">
                <form id="contacts-form" class="bg-[#18181b] p-6 rounded-xl border border-[#27272a] space-y-4">
                    <input id="contact-whatsapp-input" placeholder="WHATSAPP">
                    <input id="contact-telegram-input" placeholder="TELEGRAM">
                    <input id="contact-email-input" placeholder="EMAIL">
                    <input id="imgbb-api-key-input" placeholder="IMGBB API KEY">
                    <button type="submit" class="btn btn-primary w-full">Save</button>
                </form>
             </div>
        </main>
    </div>
    <script src="admin.js"></script>
</body>
</html>